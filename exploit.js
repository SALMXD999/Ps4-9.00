(async function run_hax() {
  const progress = (msg) => document.getElementById('progress').textContent = msg;

  try {
    progress('Fetching exfathax.img…');
    const imgResp = await fetch('https://github.com/SALMXD999/Ps4-9.00/raw/refs/heads/main/exfathax.img');
    if (!imgResp.ok) throw new Error('Failed to fetch exfathax.img');
    const imgBuf = await imgResp.arrayBuffer();

    progress('Loading kernel exploit…');
    if (typeof usb === 'undefined' || !usb.load) {
      throw new Error('usb.load() not defined');
    }
    await usb.load(imgBuf);

    progress('Fetching GoldHEN…');
    const goldResp = await fetch('https://github.com/SALMXD999/Ps4-9.00/raw/refs/heads/main/goldheh_v2.4b18.3.bin');
    if (!goldResp.ok) throw new Error('Failed to fetch goldhen.bin');
    const goldBuf = await goldResp.arrayBuffer();

    progress('Launching GoldHEN…');
    if (typeof kernel === 'undefined' || !kernel.exec) {
      throw new Error('kernel.exec() not defined');
    }
    await kernel.exec(goldBuf);

    progress('GoldHEN should be running!');
  } catch (e) {
    progress('Error: ' + e.message);
  }
})();
